<ResourceDictionary
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:strix="using:StrixMusic.Sdk.Uno.Controls"
    xmlns:shell="using:StrixMusic.Sdk.Uno.Controls.Shells"
    xmlns:owlcoreuno="using:OwlCore.Uno.Controls"
    xmlns:conveternum="using:OwlCore.Uno.Converters.Numerical"
    xmlns:sdk="using:StrixMusic.Sdk"
    x:Class="StrixMusic.Sdk.Uno.Styles.Shells.NowPlayingBarStyle">

    <ResourceDictionary.MergedDictionaries>
        <ResourceDictionary Source="ms-appx:///StrixMusic.Sdk.Uno/Styles/MediaSlider.xaml" />
    </ResourceDictionary.MergedDictionaries>

    <Style x:Key="DefaultNowPlayingBarStyle" TargetType="shell:NowPlayingBar">
        <Style.Setters>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="shell:NowPlayingBar">
                        <ContentControl HorizontalContentAlignment="Stretch" VerticalContentAlignment="Stretch">
                            <ContentControl.ContentTemplate>
                                <DataTemplate x:DataType="sdk:MainViewModel">
                                    <UserControl>
                                        <Grid VerticalAlignment="Center">
                                            <VisualStateManager.VisualStateGroups>
                                                <VisualStateGroup x:Name="Sizes">
                                                    <VisualState x:Name="Small">
                                                        <VisualState.StateTriggers>
                                                            <AdaptiveTrigger x:Name="SmallTrigger" MinWindowWidth="0"/>
                                                        </VisualState.StateTriggers>
                                                        <VisualState.Setters>
                                                            <!--<Setter Target="sliderGrid.Visibility" Value="Collapsed"/>-->
                                                            <Setter Target="sliderRow.Height" Value="48"/>
                                                            <Setter Target="slider.(Grid.Row)" Value="1"/>
                                                            <Setter Target="slider.(Grid.Column)" Value="0"/>
                                                            <Setter Target="slider.(Grid.ColumnSpan)" Value="3"/>
                                                        </VisualState.Setters>
                                                    </VisualState>
                                                    <VisualState x:Name="Large">
                                                        <VisualState.StateTriggers>
                                                            <AdaptiveTrigger MinWindowWidth="1200"/>
                                                        </VisualState.StateTriggers>
                                                        <VisualState.Setters>
                                                            <!--<Setter Target="sliderGrid.Visibility" Value="Visible"/>-->
                                                            <Setter Target="sliderRow.Height" Value="0"/>
                                                            <Setter Target="slider.(Grid.Row)" Value="0"/>
                                                            <Setter Target="slider.(Grid.Column)" Value="1"/>
                                                            <Setter Target="slider.(Grid.ColumnSpan)" Value="1"/>
                                                        </VisualState.Setters>
                                                    </VisualState>
                                                </VisualStateGroup>
                                            </VisualStateManager.VisualStateGroups>

                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="96"/>
                                                <RowDefinition x:Name="sliderRow" Height="0"/>
                                            </Grid.RowDefinitions>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="auto"/>
                                                <ColumnDefinition x:Name="sliderColumn"/>
                                                <ColumnDefinition Width="auto"/>
                                            </Grid.ColumnDefinitions>
                                            <Grid MaxWidth="300">
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="auto"/>
                                                    <ColumnDefinition/>
                                                </Grid.ColumnDefinitions>
                                                <StackPanel Grid.Column="1" Margin="8,0,0,0" VerticalAlignment="Center">
                                                    <TextBlock Text="{Binding ActiveDevice.NowPlaying.Name, Mode=OneWay}"/>
                                                    <!--<TextBlock Text="{x:Bind ActiveDevice.NowPlaying.Name, Mode=OneWay}" Opacity=".5"/>--> <!--TODO: Artist-->
                                                </StackPanel>

                                                <strix:SafeImage DataContext="{Binding ActiveDevice.NowPlaying, Mode=OneWay}"/>

                                                <!--<Rectangle Fill="#FF00FF" Width="96" Height="96"/>-->
                                            </Grid>

                                            <strix:ProgressSlider x:Name="slider" Grid.Column="1" VerticalAlignment="Center" Style="{StaticResource MediaSlider}"
                                                                  Minimum="0" Maximum="{Binding ActiveDevice.NowPlaying.Duration.TotalMilliseconds, Mode=OneWay}" 
                                                                  FlowDirection="LeftToRight"/>

                                            <StackPanel Orientation="Horizontal" Grid.Column="2">
                                                <!--Skip and Prev buttons shouldn't flip with Bi-directional languages-->
                                                <StackPanel Orientation="Horizontal" FlowDirection="LeftToRight">
                                                    <Button Style="{StaticResource MediaButton}"  Command="{Binding ActiveDevice.PreviousAsyncCommand, Mode=OneWay}">
                                                        <FontIcon Glyph="&#xE100;" FontFamily="ms-appx://StrixMusic.Sdk.Uno/Assets/SegoeMDL2.ttf#Segoe MDL2 Assets"/>
                                                    </Button>
                                                    <owlcoreuno:ToggleContentButton Style="{StaticResource MediaToggleContentButton}">
                                                        <owlcoreuno:ToggleContentButton.CheckedContent>
                                                            <FontIcon Glyph="&#xE103;" FontFamily="ms-appx://StrixMusic.Sdk.Uno/Assets/SegoeMDL2.ttf#Segoe MDL2 Assets"/>
                                                        </owlcoreuno:ToggleContentButton.CheckedContent>
                                                        <FontIcon Glyph="&#xE102;" FontFamily="ms-appx://StrixMusic.Sdk.Uno/Assets/SegoeMDL2.ttf#Segoe MDL2 Assets"/>
                                                    </owlcoreuno:ToggleContentButton>
                                                    <Button Style="{StaticResource MediaButton}" Command="{Binding ActiveDevice.NextAsyncCommand, Mode=OneWay}">
                                                        <FontIcon Glyph="&#xE101;" FontFamily="ms-appx://StrixMusic.Sdk.Uno/Assets/SegoeMDL2.ttf#Segoe MDL2 Assets"/>
                                                    </Button>
                                                </StackPanel>
                                                <owlcoreuno:ToggleContentButton IsThreeState="True" Style="{StaticResource MediaToggleContentButton}">
                                                    <owlcoreuno:ToggleContentButton.IndeterminateContent>
                                                        <FontIcon Glyph="&#xE1CC;" FontFamily="ms-appx://StrixMusic.Sdk.Uno/Assets/SegoeMDL2.ttf#Segoe MDL2 Assets"/>
                                                    </owlcoreuno:ToggleContentButton.IndeterminateContent>
                                                    <owlcoreuno:ToggleContentButton.CheckedContent>
                                                        <FontIcon Glyph="&#xE1CD;" FontFamily="ms-appx://StrixMusic.Sdk.Uno/Assets/SegoeMDL2.ttf#Segoe MDL2 Assets"/>
                                                    </owlcoreuno:ToggleContentButton.CheckedContent>
                                                    <FontIcon Glyph="&#xE194;" FontFamily="ms-appx://StrixMusic.Sdk.Uno/Assets/SegoeMDL2.ttf#Segoe MDL2 Assets"/>
                                                </owlcoreuno:ToggleContentButton>
                                                <Button Style="{StaticResource MediaButton}">
                                                    <FontIcon Glyph="&#xE8B1;" FontFamily="ms-appx://StrixMusic.Sdk.Uno/Assets/SegoeMDL2.ttf#Segoe MDL2 Assets"/>
                                                </Button>
                                            </StackPanel>
                                        </Grid>
                                    </UserControl>
                                </DataTemplate>
                            </ContentControl.ContentTemplate>
                        </ContentControl>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style.Setters>
    </Style>

    <Style BasedOn="{StaticResource DefaultNowPlayingBarStyle}" TargetType="shell:NowPlayingBar"/>

</ResourceDictionary>