<Page
    x:Class="StrixMusic.Controls.Settings.MusicSources.ConnectNew.Ipfs.LandingPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:labs="using:CommunityToolkit.Labs.WinUI"
    xmlns:local="using:StrixMusic.Controls.Settings.MusicSources.ConnectNew.Ipfs"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    Background="{ThemeResource ApplicationPageBackgroundThemeBrush}"
    mc:Ignorable="d">

    <StackPanel
        MaxWidth="550"
        Margin="20"
        Spacing="0">

        <StackPanel Grid.Row="1" Spacing="12">
            <Image
                MaxWidth="250"
                MaxHeight="250"
                Source="ms-appx:///Assets/Cores/ipfs/access.svg" />
        </StackPanel>
        <labs:SettingsCard ContentAlignment="Left">
            <StackPanel>
                <Grid>
                    <TextBlock FontWeight="Bold" Text="Configure folder" />
                    <ProgressRing IsActive="{x:Bind InProgress, Mode=OneWay}" />
                </Grid>
                <!--<StackPanel
                    HorizontalAlignment="Center"
                    Orientation="Horizontal"
                    Visibility="{x:Bind Param.AppRoot.Ipfs.InitCommand.IsRunning, Mode=OneWay}">
                    <TextBlock FontWeight="Bold" Text="Preparing to run the daemon..." />
                    <ProgressRing
                        Width="10"
                        Height="10"
                        Background="Black"
                        IsActive="{x:Bind Param.AppRoot.Ipfs.InitCommand.IsRunning, Mode=OneWay}" />
                </StackPanel>-->

                <StackPanel Margin="0,-20,0,0" Spacing="17">

                    <TextBlock
                        Width="300"
                        FontWeight="Bold"
                        Foreground="Red"
                        Text="{x:Bind ErrorMessage, Mode=OneWay}"
                        TextWrapping="WrapWholeWords" />

                    <TextBox
                        Width="300"
                        Header="IPFS Folder Path (Cid)"
                        PlaceholderText="Enter path"
                        Text="{x:Bind Settings.IpfsCidPath, Mode=TwoWay, FallbackValue='', UpdateSourceTrigger='LostFocus'}" />

                    <TextBox
                        Width="300"
                        Header="IPNS Address"
                        IsEnabled="True"
                        PlaceholderText="Enter address"
                        Text="{x:Bind Settings.IpnsAddress, Mode=TwoWay, FallbackValue='', UpdateSourceTrigger='LostFocus'}" />

                    <StackPanel Orientation="Horizontal" Spacing="8">
                        <Button Command="{x:Bind CancelCommand}" Content="Cancel" />
                        <Button
                            Command="{x:Bind TryContinueCommand}"
                            Content="Continue"
                            IsEnabled="{x:Bind IsAnyValidAddress(Settings.IpfsCidPath, Settings.IpnsAddress), FallbackValue=false, Mode=OneWay}" />
                    </StackPanel>
                </StackPanel>
            </StackPanel>
        </labs:SettingsCard>
        <StackPanel Spacing="10" Visibility="{x:Bind NullToInveerseVisibility(_param.AppRoot.Ipfs.Client)}">
            <TextBlock FontWeight="Bold" Text="No IPFS Access. Please turn on IPFS from the settings to add ipfs music source." />
            <Button
                HorizontalAlignment="Right"
                Command="{x:Bind CancelCommand}"
                Content="Close" />
        </StackPanel>
    </StackPanel>
</Page>
